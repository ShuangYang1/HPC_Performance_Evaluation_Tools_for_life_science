# 生命科学高性能计算集群性能评测工具
针对生命科学计算的高性能集群性能分析及评测框架，使用代表性生物学计算软件集合，通过Prometheus监控软件对运行时 CPU、内存、IO等资源需求特征进行监控，使用计算用时、计算效率、CPU核时等关键评价指标对集群性能进行测评和打分，帮助指导生命科学计算集群的建设、提升生命科学计算生产效率。


## 测评工具能干什么？
1. 对已建集群进行性能评测，评估集群性能，帮助分析性能瓶颈，指导集群建设。
2. 对集群环境配置的性能进行综合打分，能够直观对比不同配置下的性能差异，帮助指导集群环境配置和集群设备采购。
3. 对不同生命科学计算软件的性能和资源需求进行分析，帮助指导计算任务优化和集群资源调度。

## 测评工具的特点
1. **同时提供软件运行效率分析及节点性能评测**。
2. **支持多种测评模式**（详见下文“测评内容和流程”）。
3. **支持自定义测评的计算软件**：用户可根据自身需求选择部分计算软件进行测评，模块化的测评工具也易于添加新的计算软件。
4. **支持不同集群架构**。
5. **提供详细的可视化测评报告**：包括各种图表以及性能打分。


## 测评内容和流程
针对不同的应用场景，我们提供了三个测评模块：  
- CPU测评模块（`./CPU/`）主要测评CPU集群进行生物信息学计算的性能，选用BWA、SPAdes、Bismark、STAR、Cellranger、GATK作为测试软件。  
- GPU测评模块（`./GPU/`）主要测评GPU集群进行生命科学计算的性能，选用SPONGE，GROMACS，AMBER，DSDP作为测试软件。  
- AI for life science测评模块（`./AI/`）主要评测GPU集群进行AI模型推理的性能，选用MindSPONGE和Alphafold3作为测试软件。  

测评内容都是使用每个软件提供的算例进行实际运行计算，  
- 根据任务计算期间的资源使用情况绘制雷达图，帮助分析集群配置是否存在瓶颈。
- 根据任务计算时间、CPU核时、GPU卡时、节点能耗、计算用时稳定性等多个指标进行打分。

针对不同的测评需求，每个测评模块我们都提供了四种测评模式：
1. 测试模式：测试软件的安装情况，测试软件是否能够正常运行
2. 快速测评模式：每个软件只测试一个计算任务，根据计算用时进行打分（通常用于对节点的性能进行初步快速了解，更细致的测评分析需进行后续的单节点和集群测评）。
3. 单节点深度测评模式：使用单个节点测试软件的运行性能，进行深度测评。主要测评内容包括单任务多线程并行计算效率分析、计算用时稳定性分析、大批量任务计算效率分析，根据计算用时、计算用时稳定性、计算所用的能耗进行分析和打分，输出测试报告。
    
    CPU测评模块报告内容和格式参考[CPU单节点深度测评报告](./CPU/report_example/SingleNodeMode_report.md)。

    GPU测评模块报告内容和格式参考[GPU单节点深度测评报告](./GPU/report_example/SingleNodeMode_report.md)。
4. 集群测评模式：在多个节点组成的集群上测试每个软件大批量任务的计算效率，根据计算用时、计算所用的能耗进行分析和打分，输出测试报告。
   
   CPU测评模块报告内容和格式参考[CPU集群测评报告](./CPU/report_example/ClusterMode_report.md)。

   GPU测评模块报告内容和格式参考[GPU集群测评报告](./GPU/report_example/ClusterMode_report.md)。
   
   （建议先进行单节点深度测评模式测试，根据单节点测评报告中每个软件大批量任务测试中的最佳并行规模修改集群测评模式的配置文件，然后开始集群测评）

完整的测评流程耗时较长，对于需要快速了解集群性能的用户，我们建议：
1. 先进行测试模式，验证各软件能够正常运行。
2. 再进行快速测评模式，根据测试结果中的得分，了解集群性能。

对于需要详细了解集群性能的用户，我们建议：
1. 先进行测试模式，验证各软件能够正常运行。
2. 进行单节点深度测评模式，根据输出的报告分析测评的节点配置环境是否存在瓶颈，也可比较不同配置节点的得分。
3. 根据单节点深度测评报告中每个软件大批量任务测试中的最佳并行规模修改集群测评模式的配置文件，然后进行集群测评模式。根据输出的报告分析测评的集群配置环境是否存在瓶颈，也可比较不同配置集群的得分。


## 测评工具怎么用？
根据需要测评的应用场景和设备选择对应的测评模块，将该测评模块的源码下载到待测评设备上，根据该测评模块的使用说明（`README.md`）安装所需要的运行环境和测评应用软件，然后开始测评。
- CPU测评模块的使用说明详见[./CPU/README.md](./CPU/README.md)。
- GPU测评模块的使用说明详见[./GPU/README.md](./GPU/README.md)。
- AI for life science测评模块的使用说明详见[./AI/README.md](./AI/README.md)。
